# Оценочный лист по курсу "Компьютерный практикум по Инженерной графике"

Программа предназначена для автоматизации процесса оценки домашних заданий студентов. Она позволяет преподавателю выбрать студента из списка, отметить соответствующие критерии оценки и сгенерировать отчет в виде изображения, которое можно сохранить или скопировать в буфер обмена.

## Содержание

- [Требования](#требования)
- [Установка](#установка)
- [Запуск программы](#запуск-программы)
- [Использование](#использование)
  - [Вкладка "Информация о студенте"](#вкладка-информация-о-студенте)
  - [Вкладка "Критерии оценки"](#вкладка-критерии-оценки)
  - [Вкладка "Дополнительные штрафы"](#вкладка-дополнительные-штрафы)
  - [Вкладка "Генерация отчета"](#вкладка-генерация-отчета)
- [Файлы и структура проекта](#файлы-и-структура-проекта)
- [Замечания](#замечания)
- [Техническая поддержка](#техническая-поддержка)

## Требования

- **Python 3.6 или выше**
- Установленные библиотеки:
  - `tkinter` (обычно поставляется вместе с Python)
  - `Pillow` для обработки изображений
  - `emoji` для корректного отображения эмодзи в отчёте
  - `pywin32` для копирования изображения в буфер обмена (только для Windows)
- Файлы шрифтов `gilroy-bold.ttf`, `gilroy-medium.ttf`, `gilroy-regular.ttf` (должны находиться в одной папке с программой)
- CSV-файл `student_list.csv` с информацией о студентах
  - Файл должен быть в формате CSV с разделителем `;`
  - Обязательные столбцы:
    - `ФИО`
    - `Группа`
    - `Номер Варианта`

## Установка

1. **Склонируйте репозиторий или скачайте код программы.**

2. **Установите необходимые библиотеки:**

   Откройте командную строку или терминал и выполните команды:

   ```bash
   pip install pillow
   pip install emoji
   pip install pywin32  # только для Windows
   ```

3. **Убедитесь, что файлы шрифтов находятся в одной папке с программой.**

4. **Разместите файл `student_list.csv` в папке с программой.**

## Запуск программы

В командной строке или терминале перейдите в папку с программой и выполните команду:

```bash
python main.py
```

Если у вас установлено несколько версий Python, возможно, потребуется использовать `python3`:

```bash
python3 main.py
```

## Использование

### Вкладка "Информация о студенте"

1. **Название домашней работы:**

   - Введите название текущего домашнего задания в соответствующее поле.

2. **Количество вариантов:**

   - Укажите общее количество вариантов заданий (по умолчанию 30).

3. **Группа:**

   - Выберите группу из выпадающего списка. Список групп формируется на основе данных из файла `student_list.csv`.

4. **Студент:**

   - После выбора группы, выберите студента из выпадающего списка.
   - Используйте кнопки `<<` и `>>` для перехода к предыдущему или следующему студенту в списке.

5. **Вариант:**

   - Вариант студента рассчитывается автоматически на основе его позиции в списке, если в `student_list.csv` не указан сохранённый номер.
   - Вы можете изменить вариант вручную. Изменение сохранится в `student_list.csv` и будет загружено при следующем запуске программы.

6. **Сдано вовремя:**

   - Галочка установлена по умолчанию. Снимите ее, если задание сдано с опозданием.

### Вкладка "Критерии оценки"

Здесь представлены критерии оценки с возможностью выбора соответствующих пунктов.

1. **Критерий 1: Сходство итогового эскиза с изображением (0–2 балла)**

   - Выберите один из вариантов (радиокнопки):
     - **2 балла** — Полное соответствие изображению.
     - **-1 балл** — Небольшие несовпадения:
       - Отметьте соответствующие подпункты.
     - **-2 балла** — Существенные расхождения:
       - Отметьте соответствующие подпункты.

2. **Критерий 2: Правильность использования линий построения (0–4 балла)**

   - Выберите один из вариантов:
     - **4 балла** — Все необходимые линии присутствуют и используются правильно.
     - **-1 балл за каждую ошибку**:
       - Отметьте ошибки, которые присутствуют.
     - **-4 балла** — Практически полное отсутствие линий построения.

3. **Критерий 3: Правильность использования линий изображения (обводки) (0–2 балла)**

   - Отметьте соответствующие пункты:
     - **2 балла** — Линии обводки использованы правильно.
     - **-1 балл за каждую ошибку**:
       - Отметьте ошибки, которые присутствуют.

4. **Критерий 4: Правильность использования размеров (0–2 балла)**

   - Отметьте соответствующие пункты:
     - **2 балла** — Все размеры установлены корректно.
     - **-1 балл за каждую ошибку**:
       - Отметьте ошибки, которые присутствуют.

### Вкладка "Дополнительные штрафы"

1. **Отметьте дополнительные штрафы, если они применимы:**

   - Например:
     - Неправильное название архива (-3 балла)
     - Чертеж выходит за границы листа (-1 балл)
     - И т.д.

2. **Дней просрочки сдачи задания:**

   - Укажите количество дней просрочки. За каждый день просрочки снимается 2 балла (настраивается в `criteria.json`).
   - Флажок «Сдано вовремя» синхронизирован с полем: при вводе положительного числа дней он снимается автоматически; если снять флажок вручную, программа подставит минимум один день просрочки.

3. **Поощрения:**

   - Отметьте заслуженные достижения студента.
   - Если в настройках поощрениям задан параметр `score`, соответствующие баллы будут прибавлены к итоговой оценке и попадут в комментарии отчёта.

### Вкладка "Генерация отчета"

1. **Сформировать и сохранить оценочный лист:**

   - Нажмите кнопку для генерации отчета.
   - Отчет будет сохранен в папку с названием домашней работы, указанной ранее.
   - Имя файла отчета соответствует имени студента.

2. **Скопировать картинку в буфер обмена:**

   - Нажмите кнопку для копирования отчета в буфер обмена.
   - Эта функция доступна только на Windows и требует установленного `pywin32`.

3. **Строка состояния:**

   - Внизу окна отображаются сообщения о статусе операции (например, успешное сохранение отчета).

### Горячие клавиши

- `Ctrl+Enter` или `Ctrl+S` — сформировать и сохранить отчёт.
- `Ctrl+Shift+C` — сформировать отчёт и скопировать изображение в буфер обмена.
- `Ctrl+←` / `Ctrl+→` — перейти к предыдущему или следующему студенту.

## Файлы и структура проекта

- **main.py** — основной файл программы.
- **student_list.csv** — CSV-файл со списком студентов и номерами их вариантов (создаётся автоматически с шаблоном, если отсутствует).
- **gilroy-bold.ttf**, **gilroy-medium.ttf**, **gilroy-regular.ttf** — файлы шрифтов, необходимые для корректного отображения отчета.
- **Папки с названиями домашних работ** — создаются автоматически при сохранении отчетов и содержат сгенерированные изображения.

## Замечания

- **Шрифты:**
  - Если у вас нет шрифтов Gilroy, вы можете заменить их на стандартные шрифты, указав соответствующие имена в коде (например, Arial, Times New Roman).

- **Копирование в буфер обмена:**
  - Эта функция работает только на Windows и требует установленного `pywin32`.
  - На других операционных системах копирование в буфер обмена не поддерживается.

- **Прокрутка колесиком мыши:**
  - Прокрутка работает, когда курсор находится над областью с критериями или штрафами.
  - Это реализовано для удобства навигации по длинным спискам критериев.

- **Обновление отчета:**
  - При изменении критериев необходимо снова нажать кнопку "Сформировать и сохранить оценочный лист" или "Скопировать картинку в буфер обмена" для обновления отчета.
  - Программа генерирует отчет заново при каждом нажатии этих кнопок.
